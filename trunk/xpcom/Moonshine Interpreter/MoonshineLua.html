<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
		<title>Test XPCOM Component</title>
		<script type="application/javascript">
			
			const cid = "@mshine.googlecode.com/MoonshineLua;1";
			var lua = null;
			
			function luaVersion() {
				netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
				lua = Components.classes[cid].createInstance();
				lua = lua.QueryInterface(Components.interfaces.IMoonshineLua);
				var ver = lua.GetVersion();
				alert(ver);
			}
			
			function executeCommand() {
				netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
				lua = Components.classes[cid].createInstance();
				lua = lua.QueryInterface(Components.interfaces.IMoonshineLua);
				var command = prompt('Enter a Lua or Moonshine API command:',
				'return "hello from lua"');
				var returned = lua.ExecuteCommand(command);
				alert(returned);
			}
			
			function executeScript() {
				var script = "test.lua";
				netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
				lua = Components.classes[cid].createInstance();
				lua = lua.QueryInterface(Components.interfaces.IMoonshineLua);
				var returned = lua.ExecuteScript(script);
				alert(returned);
			}
			
		</script>
	</head>
	<body>
		<fieldset>
			<input type="button" value="Lua version" onclick="luaVersion();"/>
			<input type="button" value="Execute command" onclick="executeCommand();"/>
			<input type="button" value="Execute script" onclick="executeScript();"/>
		</fieldset>
	</body>
</html>
